{"id":"node_modules/@aragon/connect-core/dist/utils/metadata.js","dependencies":[{"name":"C:\\xampp\\htdocs\\test_wp\\node_modules\\@aragon\\connect-core\\dist\\utils\\metadata.js.map","includedInParent":true,"mtime":1594248789000},{"name":"C:\\xampp\\htdocs\\test_wp\\package.json","includedInParent":true,"mtime":1595855422975},{"name":"C:\\xampp\\htdocs\\test_wp\\node_modules\\@aragon\\connect-core\\package.json","includedInParent":true,"mtime":1595838173215},{"name":"ethers","loc":{"line":4,"column":25},"parent":"C:\\xampp\\htdocs\\test_wp\\node_modules\\@aragon\\connect-core\\dist\\utils\\metadata.js","resolved":"C:\\xampp\\htdocs\\test_wp\\node_modules\\ethers\\dist\\ethers.umd.js"},{"name":"./overrides/index","loc":{"line":5,"column":24},"parent":"C:\\xampp\\htdocs\\test_wp\\node_modules\\@aragon\\connect-core\\dist\\utils\\metadata.js","resolved":"C:\\xampp\\htdocs\\test_wp\\node_modules\\@aragon\\connect-core\\dist\\utils\\overrides\\index.js"},{"name":"../params","loc":{"line":6,"column":25},"parent":"C:\\xampp\\htdocs\\test_wp\\node_modules\\@aragon\\connect-core\\dist\\utils\\metadata.js","resolved":"C:\\xampp\\htdocs\\test_wp\\node_modules\\@aragon\\connect-core\\dist\\params.js"}],"generated":{"js":"\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.resolveArtifact = exports.resolveManifest = exports.resolveMetadata = exports.fetchMetadata = exports.parseMetadata = void 0;\nconst ethers_1 = require(\"ethers\");\nconst index_1 = require(\"./overrides/index\");\nconst params_1 = require(\"../params\");\nfunction parseMetadata(name, metadata) {\n    let parsedMetaData;\n    try {\n        parsedMetaData = JSON.parse(metadata);\n    }\n    catch (error) {\n        throw new Error(`Can't parse ${name} file, invalid JSON.`);\n    }\n    return parsedMetaData;\n}\nexports.parseMetadata = parseMetadata;\nasync function fetchMetadata(fileName, contentUri) {\n    const contentHashRegEx = contentUri.match(/ipfs:(.*)/);\n    if (contentHashRegEx) {\n        const url = `${params_1.DEFAULT_IPFS_GATEWAY}/ipfs/${contentHashRegEx[1]}/${fileName}`;\n        let metadata;\n        try {\n            metadata = await ethers_1.ethers.utils.fetchJson(url);\n        }\n        catch (error) {\n            throw new Error(`Can't fetch ${url}, failed with error: {error}.`);\n        }\n        return metadata;\n    }\n    return {};\n}\nexports.fetchMetadata = fetchMetadata;\nasync function resolveMetadata(fileName, contentUri, metadata) {\n    if (metadata)\n        return parseMetadata(fileName, metadata);\n    if (contentUri)\n        return fetchMetadata(fileName, contentUri);\n    return {};\n}\nexports.resolveMetadata = resolveMetadata;\nasync function resolveManifest(data) {\n    return resolveMetadata('manifest.json', data.contentUri || undefined, data.manifest);\n}\nexports.resolveManifest = resolveManifest;\nasync function resolveArtifact(data) {\n    if (index_1.hasAppInfo(data.appId, 'apm')) {\n        return index_1.getApmInternalAppInfo(data.appId);\n    }\n    if (index_1.hasAppInfo(data.appId, 'aragon')) {\n        return index_1.getAragonOsInternalAppInfo(data.appId);\n    }\n    return resolveMetadata('artifact.json', data.contentUri || undefined, data.artifact);\n}\nexports.resolveArtifact = resolveArtifact;\n"},"sourceMaps":{"js":{"version":3,"file":"metadata.js","sourceRoot":"","sources":["../../src/utils/metadata.ts"],"names":[],"mappings":";;;AAAA,mCAA+B;AAK/B,6CAI0B;AAC1B,sCAAgD;AAGhD,SAAgB,aAAa,CAAC,IAAY,EAAE,QAAgB;IAC1D,IAAI,cAAc,CAAA;IAClB,IAAI;QACF,cAAc,GAAG,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,CAAA;KACtC;IAAC,OAAO,KAAK,EAAE;QACd,MAAM,IAAI,KAAK,CAAC,eAAe,IAAI,sBAAsB,CAAC,CAAA;KAC3D;IACD,OAAO,cAAc,CAAA;AACvB,CAAC;AARD,sCAQC;AAEM,KAAK,UAAU,aAAa,CACjC,QAAgB,EAChB,UAAkB;IAElB,MAAM,gBAAgB,GAAG,UAAU,CAAC,KAAK,CAAC,WAAW,CAAC,CAAA;IACtD,IAAI,gBAAgB,EAAE;QACpB,MAAM,GAAG,GAAG,GAAG,6BAAoB,SAAS,gBAAgB,CAAC,CAAC,CAAC,IAAI,QAAQ,EAAE,CAAA;QAC7E,IAAI,QAAQ,CAAA;QACZ,IAAI;YACF,QAAQ,GAAG,MAAM,eAAM,CAAC,KAAK,CAAC,SAAS,CAAC,GAAG,CAAC,CAAA;SAC7C;QAAC,OAAO,KAAK,EAAE;YACd,MAAM,IAAI,KAAK,CAAC,eAAe,GAAG,+BAA+B,CAAC,CAAA;SACnE;QACD,OAAO,QAAQ,CAAA;KAChB;IACD,OAAO,EAAE,CAAA;AACX,CAAC;AAhBD,sCAgBC;AAEM,KAAK,UAAU,eAAe,CACnC,QAAgB,EAChB,UAAmB,EACnB,QAAwB;IAExB,IAAI,QAAQ;QAAE,OAAO,aAAa,CAAC,QAAQ,EAAE,QAAQ,CAAC,CAAA;IACtD,IAAI,UAAU;QAAE,OAAO,aAAa,CAAC,QAAQ,EAAE,UAAU,CAAC,CAAA;IAC1D,OAAO,EAAE,CAAA;AACX,CAAC;AARD,0CAQC;AAEM,KAAK,UAAU,eAAe,CACnC,IAAwB;IAExB,OAAO,eAAe,CACpB,eAAe,EACf,IAAI,CAAC,UAAU,IAAI,SAAS,EAC5B,IAAI,CAAC,QAAQ,CACd,CAAA;AACH,CAAC;AARD,0CAQC;AAEM,KAAK,UAAU,eAAe,CACnC,IAAwB;IAExB,IAAI,kBAAU,CAAC,IAAI,CAAC,KAAK,EAAE,KAAK,CAAC,EAAE;QACjC,OAAO,6BAAqB,CAAC,IAAI,CAAC,KAAK,CAAC,CAAA;KACzC;IACD,IAAI,kBAAU,CAAC,IAAI,CAAC,KAAK,EAAE,QAAQ,CAAC,EAAE;QACpC,OAAO,kCAA0B,CAAC,IAAI,CAAC,KAAK,CAAC,CAAA;KAC9C;IACD,OAAO,eAAe,CACpB,eAAe,EACf,IAAI,CAAC,UAAU,IAAI,SAAS,EAC5B,IAAI,CAAC,QAAQ,CACd,CAAA;AACH,CAAC;AAdD,0CAcC","sourcesContent":[null]}},"error":null,"hash":"892475969232a12dcd29ac5499efce98","cacheData":{"env":{}}}